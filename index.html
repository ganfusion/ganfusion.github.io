<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Diffusion Handles enable 3D-aware object edits on images generated by diffusion models..">
  <meta name="keywords" content="Diffusion">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Diffusion Handles</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<style>
  table { 
      table-layout:fixed;
      width:100%;
  }
  img {
      max-height:100%;
      max-width:100%;
  }
  thead th {
      top: 0;
      position: sticky;
      z-index: 20;
      background-color: white;
  }
  </style>
<body>

  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
        <a class="navbar-item" href="">
        <span class="icon">
            <i class="fas fa-home"></i>
        </span>
        </a>
  
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Full Results
          </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="./static/full-results/qualitative_comparison_main.html">
              Qualitative Comparisons on PhotoGen 
            </a>
            <a class="navbar-item" href="./static/full-results/qualitative_comparison_benchmark.html">
              Qualitative Comparisons on Benchmark
            </a>
          </div>
        </div>
      </div>
  
    </div>
  </nav>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title"><span class="dnerf">Diffusion Handles: <br> Enabling 3D Edits for Diffusion Models by Lifting Activations to 3D</span>  </h1>

          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://karranpandey.github.io/">Karran Pandey</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://paulguerrero.net/">Paul Guerrero</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="http://mgadelha.me/">Matheus Gadelha</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://yannickhold.com/">Yannick Hold-Geoffroy</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.dgp.toronto.edu/~karan/">Karan Singh</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="http://www0.cs.ucl.ac.uk/staff/n.mitra/">Niloy Mitra</a><sup>2,3</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Toronto,</span>
            <span class="author-block"><sup>2</sup>Adobe Research,</span>
            <span class="author-block"><sup>3</sup>University College London</span>

          </div>

          <div class="is-size-5 publication-venue">
          CVPR 2024 - Highlight
          </div>

         <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2312.02190.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Arxiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://youtu.be/OxOjiFaTSZg"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/adobe-research/DiffusionHandles"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div> 
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <!-- <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4" type="video/mp4">
      </video> -->
      <img src="./static/images/teaser.png"
      class = "interpolation-image"
        alt="3D-aware object edits for diffusion images."/>
        <img src="./static/images/intro.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
        <h2 class="subtitle has-text-centered">
        <span class="dnerf">Diffusion Handles</span> enables 3D-aware object edits on images generated by diffusion models. The 3D edit captures complex light and shading effects, as well as a changes in perspective, which is hard to achieve by enforcing object pixel intensity invariance used in image-space identity control.
      </h2>
    </div>
  </div>
</section>

<!-- Abstract. -->
<section class="section" style="background-color:#f7f7f7">
  <div class="container is-max-desktop" >
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            <span class="dnerf">Diffusion Handles</span> is a novel approach to enabling 3D object edits on diffusion images.
            We accomplish these edits using existing pre-trained diffusion models, and 2D image depth estimation, without any fine-tuning or 3D object retrieval. The edited results remain plausible, photo-real, and preserve object identity. 
            </p>
            <span class="dnerf">Diffusion Handles</span> addresses a critically missing facet of generative image based creative design, and significantly advance the state-of-the-art in generative image editing. 
            Our key insight is to lift diffusion activations for an object to 3D using a proxy depth, 3D-transform the depth and associated activations,
            and project them back to image space. The diffusion process applied to the manipulated activations with identity control, produces plausible edited images showing complex 3D occlusion and lighting effects. 
            </p>
          <p>
            We evaluate <span class="dnerf">Diffusion Handles</span>: quantitatively, on a large synthetic data benchmark; and qualitatively by a user study, showing our output to be more plausible, and better than prior art at both, 3D editing and identity control.
          </p>
        </div>
      </div>
    </div>

    <!-- Paper video. -->
   <!--<div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>


<!-- Results. -->
<section class="section">
  <div class="container is-max-desktop is-centered has-text-centered">
        
    <h2 class="title is-3">3D-Aware Editing Results</h2>

    <!-- Main Results. -->
    <div id="results-carousel" class="carousel results-carousel">
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/toaster_screen.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/shoe.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/potted_plant_screen.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/wine_screen.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/real_car.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/plane_screen.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/guitar_screen.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
      <div class="item d-flex justify-content-center">
        <img src="./static/result-images/building_screen.png"
        class = "interpolation-image"
          alt="3D-aware object edits for diffusion images."/>
      </div>
    </div>

    <!-- Comparisons. -->
    <br/>
    <h2 class="title is-3">Comparison to the State-of-the-Art</h2>
    <table>
      <thead>
          <tr>
              <th>Input</th>
              <th>Target Edit</th>
              <th>Ours</th>
              <th>Obj. Stitch</th>
              <th>Zero123</th>
              <th>3DIT</th>
          </tr>
      </thead>
      <tbody>
          
          <tr>
              <td><img src="static/full-results/images/qualitative_comparison_main/sunflower_2_input.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/sunflower_2_edit.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/sunflower_2_ours.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/sunflower_2_objstitch.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/sunflower_2_zero123.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/sunflower_2_3dit.png"></td>
          </tr>
          
          <tr>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_jet_input.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_jet_edit.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_jet_ours.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_jet_objstitch.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_jet_zero123.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_jet_3dit.png"></td>
          </tr>
          
          <tr>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_red_car_input.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_red_car_edit.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_red_car_ours.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_red_car_objstitch.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_red_car_zero123.png"></td>
              <td><img src="static/full-results/images/qualitative_comparison_main/outputorig_red_car_3dit.png"></td>
          </tr>
      </tbody>
    </table>
    <p>(Comparison to the state-of-the-art on a much larger set of images are available here for images with <a href="./static/full-results/qualitative_comparison_main.html">estimated depth</a> & <a href="./static/full-results/qualitative_comparison_benchmark.html">synthetic depth</a>.)
    </p>
    <br/>
    <p style="text-align: left; font-size: smaller;">
      <a href="https://openaccess.thecvf.com/content/CVPR2023/papers/Song_ObjectStitch_Object_Compositing_With_Diffusion_Model_CVPR_2023_paper.pdf">ObjectStitch</a> is a generative object compositing method which we adapt for object-level editing on scenes.
      <br/>
      <a href="https://zero123.cs.columbia.edu/">Zero-1-2-3</a> is a diffusion-based novel-view synthesis method which we use in conjunction with inpainting to perform object-level 3D-aware image editing.
      <br/>
      <a href="https://prior.allenai.org/projects/object-edit">Object 3DIT</a> is a language-guided model for 3D-aware image editing.
    </p>
    <br/>

    
    <!-- Interpolation 1. -->
    <br/>
    <h2 class="title is-3">Frame-by-Frame Interpolation</h2>
    <div class="columns is-vcentered interpolation-panel">
      <div class="column is-3 has-text-centered">
        <img src="./static/interpolated-car/0.png"
              class="interpolation-image"
              alt="Interpolate start reference image."/>
        <p>Start Frame</p>
      </div>
      <div class="column interpolation-video-column">
        <div id="interpolation-image-wrapper">
          Loading...
        </div>
        <input class="slider is-fullwidth is-large is-info"
                id="interpolation-slider"
                step="1" min="0" max="100" value="0" type="range">
      </div>
      <div class="column is-3 has-text-centered">
        <img src="./static/interpolated-car/4.png"
              class="interpolation-image"
              alt="Interpolation end reference image."/>
        <p class="is-bold">End Frame</p>
      </div>
    </div>
    
    <!-- Interpolation 2. -->
    <br/>
    <div class="columns is-vcentered interpolation-panel">
      <div class="column is-3 has-text-centered">
        <img src="./static/interpolated-sunflower/0.png"
              class="interpolation-image"
              alt="Interpolate start reference image."/>
        <p>Start Frame</p>
      </div>
      <div class="column interpolation-video-column">
        <div id="interpolation-image-wrapper-2">
          Loading...
        </div>
        <input class="slider is-fullwidth is-large is-info"
                id="interpolation-slider-2"
                step="1" min="0" max="100" value="0" type="range">
      </div>
      <div class="column is-3 has-text-centered">
        <img src="./static/interpolated-sunflower/4.png"
              class="interpolation-image"
              alt="Interpolation end reference image."/>
        <p class="is-bold">End Frame</p>
      </div>
    </div>

  </div>
</section>

<!-- Method Overview. -->
<section class="section">
  <div class="container is-max-desktop" >
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method Overview</h2>
        <img src="./static/images/overview.png"
        class = "interpolation-image"
          alt="Method overview."/>
          <img src="./static/images/edit.png"
          class = "interpolation-image"
            alt="3D Edit."/>
        <div class="content has-text-justified">
          <ul>

            <li>
              The input image is first reconstructed with a depth-to-image diffusion model. Intermediate activations are recorded.
            </li>

            <li>
              Depth is estimated using a monocular depth estimator and the intermediate activations from the last step are lifted to the 3D depth surface.
            </li>

            <li>
              A user-supplied 3D transform is applied to the depth surface and the lifted activations.
            </li>

            <li>
              The 3D-transformed depth and activations are used to guide the diffusion model to generate an edited image.
            </li>
        
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="section" style="background-color:#f7f7f7">
<div class="columns is-centered">
  <div class="column is-full-width has-text-centered">
    <h2 class="title is-4">References</h2>

    <div class="content has-text-centered">
      <p>
        <a href="https://prior.allenai.org/projects/object-edit">Object 3DIT</a> is a language-guided model for 3D-aware image editing.
      </p>
      <p>
        <a href="https://openaccess.thecvf.com/content/CVPR2023/papers/Song_ObjectStitch_Object_Compositing_With_Diffusion_Model_CVPR_2023_paper.pdf">ObjectStitch</a> is a generative object compositing method which we adapt for object-level editing on scenes.
      </p>
      <p>
        <a href="https://zero123.cs.columbia.edu/">Zero-1-2-3</a> is a diffusion-based novel-view synthesis method which we use in conjunction with inpainting to perform object-level 3D-aware image editing.
      </p>
    </div>
  </div>
</div>
</section> -->

<!--/ Concurrent Work. -->


<!--<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section> -->

<!-- 
<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
          </p>
          <p>
          </p>
        </div>
      </div>
    </div>
  </div>
</footer> -->

</body>
</html>
